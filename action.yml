name: Deploy
description: üèóÔ∏è GitHub Action for deploying stacks to Portainer.

inputs:
  portainer-url:
    description: 'Portainer URL.'
    required: true

  portainer-username:
    description: 'Portainer Username.'
    required: true

  portainer-password:
    description: 'Portainer Password.'
    required: true

  portainer-endpoint-id:
    description: 'Portainer Endpoint ID.'
    required: true

  env-file:
    description: 'Env file.'
    required: true

  stack-name:
    description: 'Stack name.'
    required: true

  stack-compose-path:
    description: 'Path of docker-compose file.'
    required: true

  stack-pull-image:
    required: false
    description: 'Pull image before creating the stack.'
    default: true

  stack-prune:
    required: false
    description: 'Prune services that are no longer referenced.'
    default: true

runs:
  using: 'composite'
  steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: 20

    - name: Run Action
      run: node dist/index.js
